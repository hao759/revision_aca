import{a as ie}from"./chunk-FB4BWV6Q.js";import"./chunk-FYYLBBTR.js";import{$a as $,I as B,Jb as X,Kb as Y,L as G,Lb as ee,Nb as te,P as H,Q,R as W,U as Z,Va as K,aa as J,s as z}from"./chunk-55Y7RW7N.js";import{Ac as r,Bc as y,Bd as q,Cb as b,Cc as v,Ec as k,Fa as S,Fc as L,Gc as F,Hc as N,Hd as A,Oc as V,Rb as s,Vb as O,bc as o,cc as n,db as P,dc as f,hc as x,ib as l,kc as u,mc as _,nb as h,pc as D,ra as g,sa as m,sc as I,tc as w,uc as j,wb as M,wd as R,xd as U,yc as T}from"./chunk-XOKJR3V5.js";import{h as C}from"./chunk-WWX6BADO.js";var oe=["fileUploader"],ne=(c,d)=>({color:c,"background-color":d,"font-weight":"600"});function re(c,d){if(c&1&&(o(0,"tr",32)(1,"td",33),r(2),n(),o(3,"td"),r(4),n(),o(5,"td"),r(6),n()()),c&2){let e=d.$implicit;s("ngStyle",V(4,ne,e.bgColor?"white":"black",e.bgColor)),l(2),v("",e.id," "),l(2),y(e.product_name),l(2),y(e.qty)}}function le(c,d){if(c&1){let e=x();o(0,"c-col",21)(1,"div",22)(2,"b"),r(3),n(),o(4,"p",23),u("click",function(){let i=g(e).$implicit,a=_(2);return m(a.copyToClipboard(i.nameFile))}),r(5," Copy t\xEAn file "),f(6,"i",24),n(),o(7,"c-col",25)(8,"div",7)(9,"c-col",26)(10,"img",27),u("dblclick",function(i){g(e);let a=_(2);return m(a.onDoubleClick(i))}),n()(),o(11,"c-col",28)(12,"div",29)(13,"table",30)(14,"thead")(15,"tr")(16,"th"),r(17,"Id"),n(),o(18,"th"),r(19,"T\xEAn nh\xE3n"),n(),o(20,"th"),r(21,"S\u1ED1 l\u01B0\u1EE3ng"),n()()(),o(22,"tbody"),b(23,re,7,7,"tr",31),n()()()()()()()()}if(c&2){let e=d.$implicit,t=d.index,i=_(2);l(3),k("",t+1,"/",i.qty_image," T\u1ED5ng nh\xE3n detect \u0111\u01B0\u1EE3c: ",e.qty_product!==0?e.qty_product:e.qty_productapi," "),l(7),D("src",e.img,P),l(13),s("ngForOf",e.product)}}function ce(c,d){if(c&1&&(o(0,"div",19),b(1,le,24,5,"c-col",20),n()),c&2){let e=_();l(),s("ngForOf",e.result)}}function ae(c,d){c&1&&(o(0,"div",34)(1,"ul",35)(2,"li",36),r(3,"L"),n(),o(4,"li",37),r(5,"O"),n(),o(6,"li",38),r(7,"A"),n(),o(8,"li",39),r(9,"D"),n(),o(10,"li",40),r(11,"I"),n(),o(12,"li",41),r(13,"N"),n(),o(14,"li",42),r(15,"G"),n()()())}var De=(()=>{class c{constructor(e,t,i){this.service=e,this.router=t,this.el=i,this.title="DetectImg",this.uploadedFiles=[],this.loading=!1,this.result=[],this.productList=[[],[],[],[],[],[],[]],this.toast={visible_toast:!1,message_toast:"",background:""},this.list_bgColor=["rgb(78, 128, 127)","rgb(255, 76, 76)","rgb(39, 77, 96)","rgb(94, 121, 202)","rgb(165, 76, 202)","rgb(188, 165, 72)","rgb(255, 179, 50)","rgb(133, 58, 0)","rgb(236, 104, 104)","rgb(128, 185, 128)","rgb(0, 188, 178)","rgb(76, 140, 174)","rgb(200, 120, 120)","rgb(113, 161, 210)","rgb(255, 128, 191)","rgb(163, 64, 84)","rgb(200, 159, 128)","rgb(94, 159, 107)","rgb(100, 97, 148)","rgb(0, 115, 103)","rgb(84, 140, 110)","rgb(105, 59, 255)","rgb(91, 82, 129)","rgb(255, 101, 174)","rgb(10, 112, 117)","rgb(94, 145, 156)","rgb(28, 143, 202)","rgb(27, 25, 49)","rgb(82, 44, 93)","rgb(255, 130, 139)","rgb(3, 18, 47)","rgb(255, 128, 153)","rgb(12, 150, 156)","rgb(142, 170, 224)","rgb(0, 159, 0)","rgb(255, 128, 128)","rgb(241, 145, 109)","rgb(68, 23, 78)","rgb(102, 34, 73)","rgb(24, 26, 47)","rgb(36, 46, 73)","rgb(180, 129, 45)","rgb(84, 22, 43)","rgb(13, 30, 76)","rgb(95, 126, 162)","rgb(38, 65, 94)","rgb(11, 27, 50)","rgb(3, 47, 48)","rgb(107, 163, 190)","rgb(25, 48, 92)","rgb(65, 56, 97)","rgb(174, 125, 172)","rgb(21, 0, 22)","rgb(41, 16, 74)","rgb(132, 81, 98)"],this.length_list_bgColor=this.list_bgColor.length}ngOnInit(){this.items=[{label:" MASTER"},{label:"Detect"}],this.home={icon:"pi pi-home",routerLink:"/detect"},this.projectList=[{name:"UMER PROMOTION Demo",code:6,idProject:30,promotion_id:1,group_code:""},{name:"KEN Demo",code:2,idProject:34,promotion_id:1,group_code:""},{name:"UMER Demo",code:1,idProject:30,promotion_id:1,group_code:""},{name:"PEPSI ALL",code:0,idProject:31,promotion_id:2,group_code:""},{name:"PEPSI Demo",code:3,idProject:31,promotion_id:1,group_code:""},{name:"OTHER Demo",code:4,idProject:99,promotion_id:1,group_code:""}],this.selected_project=this.projectList[0].code}clearFiles(e){e.clear()}getProjectSelectd(e){return this.projectList.filter(t=>t.code==e)}onUpload(e){return C(this,null,function*(){if(!(e.srcElement.files.length<1)){this.selected_projectfull=this.getProjectSelectd(this.selected_project)[0],console.log("this.selected_projectfull",this.selected_projectfull),this.productList[this.selected_project][0]||(yield this.get_lable_project(this.selected_projectfull.idProject,this.selected_projectfull.group_code)),this.qty_image=e.srcElement.files.length,this.dem=e.srcElement.files.length,this.loading=!0,this.result=[],this.preloading=!0;for(let t=0;t<e.srcElement.files.length;t++)console.log("event.srcElement",e.srcElement.files[t]),this.callAPI(e.srcElement.files[t])}})}toggleToast(e,t){this.toast.visible_toast=!0,this.toast.background=t,this.toast.message_toast=e,setTimeout(()=>{this.toast.visible_toast=!1},2e3)}get_lable_project(e,t){return C(this,null,function*(){this.subscription=this.service.Get_Dynamic_detect_label(e,t).subscribe(i=>{console.log("data Get_Dynamic_detect_label",i),this.productList[this.selected_project]=i.data},i=>{this.toggleToast("C\xF3 l\u1ED7i x\u1EA3y ra, vui l\xF2ng th\u1EED l\u1EA1i","bg-danger")})})}copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{this.toggleToast("Copy th\xE0nh c\xF4ng"+e,"bg-success")}).catch(t=>{this.toggleToast("Copy l\u1ED7i "+e,"bg-danger")})}callAPI(e){this.subscription=this.service.uploadImage(e,this.selected_projectfull.idProject,this.selected_projectfull.promotion_id).subscribe(t=>{var i=this.handleProductsList(t.products);this.result.push({product:t.products,img:"https://brand-detect4.acacy.vn/img_pred/"+t.img_out,qty_product:i,nameFile:e.name,qty_productapi:t.brands.length!==0?t.brands.length:0}),this.preloading=!1},t=>{console.log(t),this.preloading=!1,this.toggleToast("C\xF3 l\u1ED7i x\u1EA3y ra, vui l\xF2ng th\u1EED l\u1EA1i","bg-danger")})}addImageZoom(e){let t=[{id:1,src:e,title:" ",image_time:"item.image_time",_index:1}],i=1;localStorage.setItem("listphoto",JSON.stringify(t)),localStorage.setItem("changeindex",JSON.stringify(i)),this.urlgallery="assets/ZoomImage/tool.html",document.open(this.urlgallery,"image_default","height=700,width=900,top=100,left= 539.647")}onDoubleClick(e){localStorage.getItem("detailDetect")&&localStorage.removeItem("detailDetect"),this.addImageZoom(e.srcElement.currentSrc)}handleProductsList(e){var t=0;return e.forEach(i=>{for(let a of this.productList[this.selected_project])if(i.product_name==a.SkuLabel){t+=i.qty,i.id=a.id;return}}),this.handleColor(e),t}handleColor(e){e.forEach((t,i)=>{t.bgColor=this.list_bgColor[Math.floor(Math.random()*this.length_list_bgColor)]}),e.sort((t,i)=>t.id-i.id)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static{this.\u0275fac=function(t){return new(t||c)(h(ie),h(z),h(S))}}static{this.\u0275cmp=M({type:c,selectors:[["app-detect"]],viewQuery:function(t,i){if(t&1&&I(oe,5),t&2){let a;w(a=j())&&(i.fileUploader=a.first)}},decls:37,vars:16,consts:[["fileUploader",""],[2,"position","fixed","top","80px","right","0","background-color","cornflowerblue","color","white","z-index","1000",3,"autohide","delay","visible"],[1,"mr-auto"],[1,"container1"],[1,"col-12","mt-1",2,"text-align","center"],[1,"col-12",2,"text-align","center"],[1,"card"],[1,"row"],["md","3"],[1,"upload-content","text-center","p-2",2,"margin-top","5%"],["type","file","hidden","","multiple","","accept","image/*",3,"change"],["cButton","","color","primary",3,"click"],[1,"mt-2","small","text-muted"],[1,"clearfix"],[1,"pt-2"],["cSelect","",2,"padding","5px","border-radius","5px","border","1px solid #ccc",3,"ngModelChange","ngModel"],[3,"value"],["class","mt-5",4,"ngIf"],["style","z-index: 1;",4,"ngIf"],[1,"mt-5"],["xs","12","class","mt-5",4,"ngFor","ngForOf"],["xs","12",1,"mt-5"],[1,"mt-3"],[2,"cursor","pointer","font-size","13px","font-weight","bold","float","right","right","55px","position","relative",3,"click"],[1,"pi","pi-copy",2,"font-size","15px"],["xs","12",1,"mt-3"],["xs","9"],["cImg","","fluid","","width","100%",3,"dblclick","src"],["xs","3"],[2,"top","9%","position","sticky","max-height","85vh","overflow-y","auto"],[2,"width","100%"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[2,"padding","10px"],[2,"z-index","1"],[1,"preload"],["data-title","L"],["data-title","O"],["data-title","A"],["data-title","D"],["data-title","I"],["data-title","N"],["data-title","G"]],template:function(t,i){if(t&1){let a=x();o(0,"c-toast",1)(1,"c-toast-header")(2,"strong",2),r(3,"Th\xF4ng b\xE1o"),n()(),o(4,"c-toast-body"),r(5),n()(),o(6,"div",3),f(7,"div",4),o(8,"div",5)(9,"div",6)(10,"div",7)(11,"c-col",8)(12,"div",9)(13,"input",10,0),u("change",function(p){return g(a),m(i.onUpload(p))}),n(),o(15,"button",11),u("click",function(){g(a);let p=T(14);return m(p.click())}),r(16," Ch\u1ECDn H\xECnh "),n(),f(17,"p",12),n()(),o(18,"c-col",8)(19,"span",13)(20,"h6",14),r(21,"Ch\u1ECDn Project"),n()(),o(22,"select",15),N("ngModelChange",function(p){return g(a),F(i.selected_project,p)||(i.selected_project=p),m(p)}),o(23,"option",16),r(24,"UMER PROMOTION Demo"),n(),o(25,"option",16),r(26,"KEN Demo"),n(),o(27,"option",16),r(28,"UMER Demo"),n(),o(29,"option",16),r(30,"PEPSI ALL"),n(),o(31,"option",16),r(32,"PEPSI Demo"),n(),o(33,"option",16),r(34,"OTHER Demo"),n()()()()()(),b(35,ce,2,1,"div",17)(36,ae,16,0,"div",18),n()}t&2&&(s("autohide",!0)("delay",2e3)("visible",i.toast.visible_toast),l(4),O(i.toast.background),l(),v(" ",i.toast.message_toast," "),l(17),L("ngModel",i.selected_project),l(),s("value",6),l(2),s("value",2),l(2),s("value",1),l(2),s("value",0),l(2),s("value",3),l(2),s("value",4),l(2),s("ngIf",i.result.length>0),l(),s("ngIf",i.preloading))},dependencies:[K,J,$,Z,Q,W,H,B,G,A,R,U,q,te,Y,X,ee],styles:["[_nghost-%COMP%]   c-card[_ngcontent-%COMP%]{min-width:9rem}.content[_ngcontent-%COMP%]{margin-top:50px;margin-left:50px;display:flex;justify-content:space-evenly}.container1[_ngcontent-%COMP%]{margin-bottom:90px}.flex1[_ngcontent-%COMP%]{justify-content:flex-start;display:flex;padding-left:20px}.font-medium[_ngcontent-%COMP%]{text-align:center;font-size:20px}.buttonUpload[_ngcontent-%COMP%]:hover, img[_ngcontent-%COMP%]{cursor:pointer}.hide1[_ngcontent-%COMP%]{opacity:0!important}ul[_ngcontent-%COMP%]{position:absolute;top:55%;left:50%;transform:translate(-50%,-50%) skew(-25deg);display:flex;margin:0;padding:0;border:4px solid rgb(24,176,176);box-shadow:0 20px 10px #0003}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none;width:80px;height:80px;background:#18b0b0;font-size:3em;color:#0000001a;text-align:center;line-height:80px;box-sizing:border-box;overflow:hidden;margin:0 -1px}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:attr(data-title);position:absolute;top:0;left:0;width:100%;height:100%;color:#262626;animation:_ngcontent-%COMP%_animate 2s linear infinite}@keyframes _ngcontent-%COMP%_animate{0%{top:-100%}20%{top:0%;background:transparent;color:#262626}40%{top:0%;background:#262626;color:#18b0b0}60%{top:0%;background:transparent;color:#262626}80%{top:-20%;background:transparent;color:#262626}to{top:100%}}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(1):before{animation-delay:0s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2):before{animation-delay:.1s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3):before{animation-delay:.2s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4):before{animation-delay:.3s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(5):before{animation-delay:.4s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(6):before{animation-delay:.5s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(7):before{animation-delay:.6s}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(8):before{animation-delay:.7s}"]})}}return c})();export{De as DetectComponent};
