import{b as fe,c as h}from"./chunk-Y3NE2SNJ.js";import{a as A,c as T}from"./chunk-RJESRZJ5.js";import{a as _e}from"./chunk-FYYLBBTR.js";import{Fa as $,Ga as ee,H as U,I as G,Ib as P,J as H,Jb as pe,K as z,Kb as ge,L as J,Lb as de,M as R,Ma as te,Mb as ue,Na as ne,Nb as he,Qa as ie,Ra as oe,Ta as re,U as q,Va as se,Wa as ae,X as K,aa as X,d as B,fb as le,kb as ce,lb as me,ma as Q,na as Y,oa as Z,s as W}from"./chunk-55Y7RW7N.js";import{Ac as c,Cb as M,Cc as F,Ed as j,Fc as C,Gc as y,Hc as b,Hd as N,Lc as V,Rb as g,Vb as I,ba as k,bc as i,cc as o,dc as m,ga as E,gb as L,hc as _,ib as a,kc as x,mc as p,nb as f,ra as d,sa as u,ta as v,ua as S,wb as O,xd as D}from"./chunk-XOKJR3V5.js";import"./chunk-WWX6BADO.js";var Ce=(()=>{class r{constructor(t){this.httpClient=t,this.apiUrl=_e.apiUrl+"Account/"}login(t,n,e){return this.httpClient.post(this.apiUrl+"Login",{login_name:t,password:n,fcm_token:e})}forgotPassword(t,n,e){return this.httpClient.post(this.apiUrl+"ForgotPassword",{project_id:t,login_name:n,email:e})}SendOTPtoEmail(t,n,e){return this.httpClient.post(this.apiUrl+"SendOTPtoEmail",{project_id:t,email:n,uuid:e})}ConfirmOTP(t,n,e,s,l){return this.httpClient.put(this.apiUrl+"ConfirmOTP",{project_id:t,email:n,otp:e,token:s,timeCheck:l})}static{this.\u0275fac=function(n){return new(n||r)(E(B))}}static{this.\u0275prov=k({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function we(r,w){r&1&&(i(0,"c-col",3)(1,"div",23)(2,"div",24),m(3,"img",25),o(),i(4,"div",26),m(5,"img",27),o(),i(6,"div",26),m(7,"img",28),o(),i(8,"div",26),m(9,"img",29),o(),i(10,"div",30),m(11,"span",31)(12,"span",31)(13,"span",31)(14,"span",31)(15,"span",31),o()()())}function ve(r,w){if(r&1){let t=_();i(0,"c-input-group",32)(1,"span",8),v(),m(2,"svg",33),o(),S(),i(3,"input",34),b("ngModelChange",function(e){d(t);let s=p();return y(s.password,e)||(s.password=e),u(e)}),o()()}if(r&2){let t=p();a(3),C("ngModel",t.password)}}function Se(r,w){if(r&1){let t=_();i(0,"c-input-group",7)(1,"span",8),v(),m(2,"svg",9),o(),S(),i(3,"input",35),b("ngModelChange",function(e){d(t);let s=p();return y(s.email,e)||(s.email=e),u(e)}),o()()}if(r&2){let t=p();a(3),C("ngModel",t.email)}}function Me(r,w){if(r&1){let t=_();i(0,"button",36),x("keypress",function(e){d(t);let s=p();return u(s.onSomeAction(e))},!1,L)("click",function(){d(t);let e=p();return u(e.onSubmit())}),c(1," Login "),o()}}function xe(r,w){if(r&1){let t=_();i(0,"button",36),x("keypress",function(e){d(t);let s=p();return u(s.onSomeAction(e))},!1,L)("click",function(){d(t);let e=p();return u(e.onSubmit())}),c(1," Check "),o()}}var Ge=(()=>{class r{constructor(t,n,e,s){this._edCrypt=t,this.userService=n,this.router=e,this.toastService=s,this.isLoading=!1,this.username=null,this.password=null,this.email=null,this.user_current="",this.bgLogin=!1,this.errorPass=!1,this.iserror=!1,this.showToast=!1,this.isForgot=!1}ngOnInit(){}getFormatedDate(t,n){return new j("en-US").transform(t,n)}returnClassBg(){let t=new Date,n=this.getFormatedDate(t,"yyyy-MM-dd");return n=="2024-09-17"?"vh-100 bg-trungthu":n=="2024-12-24"||n=="2024-12-25"?"vh-100 bg-noel":(this.bgLogin=!0,"vh-100")}onSomeAction(t){t.keyCode===13&&this.onSubmit()}onSubmit(){this.isLoading=!0,this.isForgot?(this.isLoading=!0,(h.IsNull(this.username)==!0||h.IsNull(this.email)==!0)&&(this.isLoading=!1,this.showToast=!0,setTimeout(()=>{this.showToast=!1},3e3)),this.userService.forgotPassword(h.ProjectID(),this.username,this.email).subscribe(t=>{t.message=="success"?(this.isLoading=!1,console.log("Password has been sent to your email")):(this.isLoading=!1,console.log("Password change fail"))})):((h.IsNull(this.username)==!0||h.IsNull(this.password)==!0)&&(this.isLoading=!1,this.showToast=!0,setTimeout(()=>{this.showToast=!1},3e3)),this.userService.login(this.username,this.password,"").subscribe(t=>{if(console.log(t),t.message=="login_name ho\u1EB7c password kh\xF4ng \u0111\xFAng"&&(this.errorPass=!0,this.isLoading=!1),t.result==A.ok){this.isLoading=!1,this.user_current=t.data,console.log(this.user_current.employee[0]);let n=this._edCrypt.encryptUsingAES256(JSON.stringify(this.user_current.employee[0]));localStorage.setItem(T.user_profile,n);let e=this._edCrypt.encryptUsingAES256(JSON.stringify(this.user_current));localStorage.setItem(T.user,e);let s=this.user_current.projects.filter(l=>l.project_id==h.ProjectID());s.length>0&&localStorage.setItem("permission_button",JSON.stringify(s[0])),this.OK()}}))}forgotPass(){console.log("forgot pass: "),console.log(this.isForgot),this.isForgot=!this.isForgot}OK(){this.isForgot||(this.user_current,this.router.navigate(["/qcresult"]))}static{this.\u0275fac=function(n){return new(n||r)(f(fe),f(Ce),f(W),f(P))}}static{this.\u0275cmp=O({type:r,selectors:[["app-login"]],features:[V([P])],decls:43,vars:16,consts:[["breakpoint","md",1,""],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],["lg","6",4,"ngIf"],["lg","6"],[1,"p-4"],["cForm",""],[1,"text-body-secondary"],[1,"mb-3"],["cInputGroupText",""],["cIcon","","name","cilUser"],["autoComplete","username","name","username","cFormControl","","placeholder","Username",3,"ngModelChange","ngModel"],["class","mb-4",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"d-flex","justify-content-between"],["xs","6"],["cButton","","class","px-4","color","primary",3,"keypress","click",4,"ngIf"],["xs","6",1,"text-right"],[1,"btn-forgot","cursor-pointer","text-sm","font-bold","text-primary",3,"click"],["placement","middle-end"],["color","warning",3,"autohide","fade","visible"],["size","lg","backdrop","static","keyboard","false",1,"d-flex","align-items-center","justify-content-center",3,"visibleChange","visible"],[1,"text-center"],["color","primary",1,"mb-3"],["id","slider"],[1,"slides","active"],["src","https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/draw2.webp","width","100%"],[1,"slides"],["src","https://blog.darwinbox.com/hubfs/MicrosoftTeams-image%20%287%29-Dec-02-2022-12-31-53-6651-PM.png","width","100%"],["src","https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdf5FOnbXMq0AegJxGDPQRmBXGS6n5BHRBhA&s","width","100%"],["src","https://itsm.tools/wp-content/uploads/2020/07/successful-employees.png","width","100%"],["id","dot",2,"display","none"],[1,"dot"],[1,"mb-4"],["cIcon","","name","cilLockLocked"],["name","password","autoComplete","current-password","cFormControl","","placeholder","Password","type","password",3,"ngModelChange","ngModel"],["autoComplete","username","name","email","cFormControl","","placeholder","Email",3,"ngModelChange","ngModel"],["cButton","","color","primary",1,"px-4",3,"keypress","click"]],template:function(n,e){n&1&&(i(0,"section")(1,"c-container",0)(2,"c-row",1),M(3,we,16,0,"c-col",2),i(4,"c-col",3)(5,"c-card-group")(6,"c-card",4)(7,"c-card-body")(8,"form",5)(9,"h1"),c(10,"Login"),o(),i(11,"p",6),c(12,"Sign In to your account"),o(),i(13,"c-input-group",7)(14,"span",8),v(),m(15,"svg",9),o(),S(),i(16,"input",10),b("ngModelChange",function(l){return y(e.username,l)||(e.username=l),l}),o()(),M(17,ve,4,1,"c-input-group",11)(18,Se,4,1,"c-input-group",12),i(19,"c-row",13)(20,"c-col",14),M(21,Me,2,0,"button",15)(22,xe,2,0,"button",15),o(),i(23,"c-col",16)(24,"p",17),x("click",function(){return e.forgotPass()}),c(25),o()()()()()()()()()()(),i(26,"c-toaster",18)(27,"c-toast",19)(28,"c-toast-header"),c(29," Login Fail! "),o(),i(30,"c-toast-body"),c(31,"Vui l\xF2ng nh\u1EADp \u0111\u1EA7y \u0111\u1EE7 th\xF4ng tin!"),o()()(),i(32,"c-toaster",18)(33,"c-toast",19)(34,"c-toast-header"),c(35," Login Fail! "),o(),i(36,"c-toast-body"),c(37,"Sai m\u1EADt kh\u1EA9u"),o()()(),i(38,"c-modal",20),b("visibleChange",function(l){return y(e.isLoading,l)||(e.isLoading=l),l}),i(39,"c-modal-body",21),m(40,"c-spinner",22),i(41,"p"),c(42,"Logining, please wait..."),o()()()),n&2&&(I(e.returnClassBg()),a(3),g("ngIf",e.bgLogin),a(13),C("ngModel",e.username),a(),g("ngIf",!e.isForgot),a(),g("ngIf",e.isForgot),a(3),g("ngIf",!e.isForgot),a(),g("ngIf",e.isForgot),a(3),F(" ",e.isForgot?"Login":"Forgot password?"," "),a(2),g("autohide",!1)("fade",!0)("visible",e.showToast),a(6),g("autohide",!1)("fade",!0)("visible",e.errorPass),a(5),C("visible",e.isLoading))},dependencies:[re,ae,se,Z,Q,Y,$,ee,ne,K,te,X,q,R,U,G,H,J,z,N,D,he,ge,pe,de,ue,me,le,ce,oe,ie],styles:['divider[_ngcontent-%COMP%]:after, .divider[_ngcontent-%COMP%]:before{content:"";flex:1;height:1px}.h-custom[_ngcontent-%COMP%]{height:calc(100% - 73px)}section[_ngcontent-%COMP%]{background:url(https://mianco.com.vn/wp-content/uploads/2020/02/Background-login.jpg) no-repeat center center;background-size:cover;display:flex;align-items:center;justify-content:center;height:100vh}@media (max-width: 450px){.h-custom[_ngcontent-%COMP%]{height:100%}}.bg-trungthu[_ngcontent-%COMP%]{background-image:url(https://img3.thuthuatphanmem.vn/uploads/2019/09/11/anh-background-de-tai-trung-thu_105458853.jpg);height:100vh;background-position:center;background-repeat:no-repeat;background-size:cover}.bg-noel[_ngcontent-%COMP%]{background-image:url(https://inlayngay.vn/media/data/blog/2021/noel_2021/vector_noel1.jpg);height:100%;background-position:center;background-repeat:no-repeat;background-size:cover}.btn-forgot[_ngcontent-%COMP%]{cursor:pointer;text-align:right}.btn-forgot[_ngcontent-%COMP%]:hover{text-decoration:underline}#slider[_ngcontent-%COMP%]{position:relative;width:100%;height:300px;overflow:hidden}#slider[_ngcontent-%COMP%]   .slides[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;opacity:0;animation:_ngcontent-%COMP%_fade 12s infinite}#slider[_ngcontent-%COMP%]   .slides[_ngcontent-%COMP%]:nth-child(1){animation-delay:0s}#slider[_ngcontent-%COMP%]   .slides[_ngcontent-%COMP%]:nth-child(2){animation-delay:3s}#slider[_ngcontent-%COMP%]   .slides[_ngcontent-%COMP%]:nth-child(3){animation-delay:6s}#slider[_ngcontent-%COMP%]   .slides[_ngcontent-%COMP%]:nth-child(4){animation-delay:9s}@keyframes _ngcontent-%COMP%_fade{0%{opacity:0}10%{opacity:1}30%{opacity:1}40%{opacity:0}to{opacity:0}}img[_ngcontent-%COMP%]{width:100%}.active[_ngcontent-%COMP%]{background:#000}#heading[_ngcontent-%COMP%]{display:block;text-align:center;font-size:2em;margin:10px 0}']})}}return r})();export{Ge as LoginComponent};
